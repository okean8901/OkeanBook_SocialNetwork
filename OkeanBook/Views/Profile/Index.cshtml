@model OkeanBook.Models.ViewModels.ProfileViewModel
@{
    ViewData["Title"] = "Hồ sơ cá nhân - OkeanBook";
}

<div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900/20 to-slate-900 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Profile Header -->
        <div class="mb-8">
            <div class="bg-white/10 backdrop-blur-xl rounded-3xl overflow-hidden border border-white/20 shadow-2xl">
                <!-- Cover Photo -->
                <div class="relative h-64 bg-gradient-to-r from-purple-600 to-blue-600">
                    <div class="absolute top-4 right-4 flex space-x-2">
                        <button class="bg-white/90 hover:bg-white text-gray-800 px-4 py-2 rounded-2xl text-sm font-semibold transition-all shadow-lg" data-bs-toggle="modal" data-bs-target="#coverPhotoModal">
                            <i class="fas fa-camera mr-2"></i>Thay đổi ảnh bìa
                        </button>
                    </div>
                </div>
                
                <!-- Profile Info -->
                <div class="p-8">
                    <div class="flex flex-col md:flex-row">
                        <div class="md:w-1/3 text-center mb-6 md:mb-0">
                            <div class="relative inline-block -mt-20">
                                <img src="@(Model?.Avatar ?? "~/img/default-avatar.png")" alt="Avatar" class="w-36 h-36 rounded-2xl ring-4 ring-white/50 shadow-2xl object-cover">
                                <button class="absolute -bottom-2 -right-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white w-10 h-10 rounded-xl transition-all shadow-lg" data-bs-toggle="modal" data-bs-target="#avatarModal">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                        </div>
                        <div class="md:w-2/3 md:pl-8">
                            <div class="flex flex-col md:flex-row md:items-start md:justify-between">
                                <div class="mb-6 md:mb-0">
                                    <h2 class="text-white text-3xl font-extrabold mb-2">@(Model?.UserName ?? User.Identity?.Name ?? "Người dùng")</h2>
                                    <p class="text-white/70 text-lg mb-4">@(Model?.Bio ?? "Chưa có thông tin giới thiệu")</p>
                                    <div class="flex flex-wrap items-center text-white/70 gap-x-6 gap-y-2">
                                        <div class="flex items-center">
                                            <i class="fas fa-map-marker-alt mr-2 text-purple-300"></i>
                                            <span>Việt Nam</span>
                                        </div>
                                        <div class="flex items-center">
                                            <i class="fas fa-calendar-alt mr-2 text-purple-300"></i>
                                            <span>Tham gia @(Model.CreatedAt.ToString("MMMM yyyy"))</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex space-x-3">
                                    <a asp-controller="Profile" asp-action="Edit" class="bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-6 py-3 rounded-2xl font-semibold transition-all shadow-lg hover:scale-105 flex items-center">
                                        <i class="fas fa-edit mr-2"></i>Chỉnh sửa hồ sơ
                                    </a>
                                    <button class="bg-white/10 hover:bg-white/20 text-white px-6 py-3 rounded-2xl font-semibold transition-all border border-white/20 flex items-center">
                                        <i class="fas fa-share mr-2"></i>Chia sẻ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left: About + Posts -->
            <div class="lg:col-span-2 space-y-6">
                <!-- About Section -->
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 shadow-2xl">
                    <div class="flex items-center justify-between p-6 border-b border-white/20 bg-gradient-to-r from-purple-500/10 to-blue-500/10">
                        <h5 class="text-white font-bold flex items-center">
                            <i class="fas fa-info-circle text-purple-300 mr-3"></i>
                            Giới thiệu
                        </h5>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="flex items-start p-4 rounded-2xl bg-white/5 border border-white/10">
                                <i class="fas fa-birthday-cake text-white/60 mr-4 mt-1"></i>
                                <div>
                                    <p class="text-white/50 text-xs">Ngày sinh</p>
                                    <p class="text-white/90">Chưa cập nhật</p>
                                </div>
                            </div>
                            <div class="flex items-start p-4 rounded-2xl bg-white/5 border border-white/10">
                                <i class="fas fa-graduation-cap text-white/60 mr-4 mt-1"></i>
                                <div>
                                    <p class="text-white/50 text-xs">Học vấn</p>
                                    <p class="text-white/90">Chưa cập nhật</p>
                                </div>
                            </div>
                            <div class="flex items-start p-4 rounded-2xl bg-white/5 border border-white/10">
                                <i class="fas fa-briefcase text-white/60 mr-4 mt-1"></i>
                                <div>
                                    <p class="text-white/50 text-xs">Công việc</p>
                                    <p class="text-white/90">Chưa cập nhật</p>
                                </div>
                            </div>
                            <div class="flex items-start p-4 rounded-2xl bg-white/5 border border-white/10">
                                <i class="fas fa-heart text-white/60 mr-4 mt-1"></i>
                                <div>
                                    <p class="text-white/50 text-xs">Tình trạng</p>
                                    <p class="text-white/90">Chưa cập nhật</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Posts Section -->
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 shadow-2xl">
                    <div class="flex items-center justify-between p-6 border-b border-white/20 bg-gradient-to-r from-purple-500/10 to-blue-500/10">
                        <h5 class="text-white font-bold flex items-center">
                            <i class="fas fa-newspaper text-purple-300 mr-3"></i>
                            Bài viết
                        </h5>
                        <div class="flex space-x-2">
                            <button class="px-4 py-2 rounded-2xl bg-gradient-to-r from-purple-600 to-blue-600 text-white text-sm">Tất cả</button>
                            <button class="px-4 py-2 rounded-2xl bg-white/10 border border-white/10 text-white/80 hover:text-white hover:bg-white/20 text-sm">Ảnh</button>
                            <button class="px-4 py-2 rounded-2xl bg-white/10 border border-white/10 text-white/80 hover:text-white hover:bg-white/20 text-sm">Video</button>
                        </div>
                    </div>
                    <div class="p-6 space-y-6">
                        <!-- Post 1 -->
                        <div class="bg-white/5 border border-white/10 rounded-2xl p-5">
                            <div class="flex items-center mb-4">
                                <img src="@(Model?.Avatar ?? "~/img/default-avatar.png")" alt="Avatar" class="w-12 h-12 rounded-xl ring-2 ring-white/20 mr-3">
                                <div class="flex-1 min-w-0">
                                    <h6 class="text-white font-semibold truncate">@(Model?.UserName ?? User.Identity?.Name ?? "Người dùng")</h6>
                                    <p class="text-white/50 text-xs">2 giờ trước</p>
                                </div>
                                <button class="text-white/50 hover:text-white"><i class="fas fa-ellipsis-h"></i></button>
                            </div>
                            <p class="text-white/90 mb-3">Đây là một bài viết mẫu để hiển thị giao diện profile. Bạn có thể thêm nhiều bài viết khác nhau ở đây.</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center text-white/70">
                                    <button class="like-btn mr-4 hover:text-red-400 transition-colors"><i class="far fa-heart mr-2"></i>5</button>
                                    <button class="hover:text-white"><i class="fas fa-comment mr-2"></i>2</button>
                                </div>
                                <button class="text-white/70 hover:text-white"><i class="fas fa-share mr-2"></i>Chia sẻ</button>
                            </div>
                        </div>
                        
                        <!-- Post 2 -->
                        <div class="bg-white/5 border border-white/10 rounded-2xl p-5">
                            <div class="flex items-center mb-4">
                                <img src="@(Model?.Avatar ?? "~/img/default-avatar.png")" alt="Avatar" class="w-12 h-12 rounded-xl ring-2 ring-white/20 mr-3">
                                <div class="flex-1 min-w-0">
                                    <h6 class="text-white font-semibold truncate">@(Model?.UserName ?? User.Identity?.Name ?? "Người dùng")</h6>
                                    <p class="text-white/50 text-xs">1 ngày trước</p>
                                </div>
                                <button class="text-white/50 hover:text-white"><i class="fas fa-ellipsis-h"></i></button>
                            </div>
                            <p class="text-white/90 mb-3">Chia sẻ một khoảnh khắc đẹp trong ngày!</p>
                            <img src="~/img/default-avatar.png" alt="Post Image" class="w-full rounded-2xl mb-3 object-cover">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center text-white/70">
                                    <button class="like-btn mr-4 hover:text-red-400 transition-colors"><i class="far fa-heart mr-2"></i>12</button>
                                    <button class="hover:text-white"><i class="fas fa-comment mr-2"></i>8</button>
                                </div>
                                <button class="text-white/70 hover:text-white"><i class="fas fa-share mr-2"></i>Chia sẻ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Friends / Photos / Groups -->
            <div class="space-y-6">
                <!-- Friends -->
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 shadow-2xl">
                    <div class="flex items-center justify-between p-6 border-b border-white/20 bg-gradient-to-r from-purple-500/10 to-blue-500/10">
                        <h5 class="text-white font-bold flex items-center">
                            <i class="fas fa-users text-purple-300 mr-3"></i>
                            Bạn bè
                        </h5>
                        <a href="/Friend" class="text-white/70 hover:text-white text-sm">Xem tất cả</a>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center">
                                <img src="~/img/default-avatar.png" alt="Friend" class="w-16 h-16 rounded-xl ring-2 ring-white/20 mx-auto mb-2 object-cover">
                                <p class="text-white/80 text-sm">Nguyễn Văn A</p>
                            </div>
                            <div class="text-center">
                                <img src="~/img/default-avatar.png" alt="Friend" class="w-16 h-16 rounded-xl ring-2 ring-white/20 mx-auto mb-2 object-cover">
                                <p class="text-white/80 text-sm">Trần Thị B</p>
                            </div>
                            <div class="text-center">
                                <img src="~/img/default-avatar.png" alt="Friend" class="w-16 h-16 rounded-xl ring-2 ring-white/20 mx-auto mb-2 object-cover">
                                <p class="text-white/80 text-sm">Lê Văn C</p>
                            </div>
                            <div class="text-center">
                                <img src="~/img/default-avatar.png" alt="Friend" class="w-16 h-16 rounded-xl ring-2 ring-white/20 mx-auto mb-2 object-cover">
                                <p class="text-white/80 text-sm">Phạm Thị D</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Photos -->
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 shadow-2xl">
                    <div class="flex items-center justify-between p-6 border-b border-white/20 bg-gradient-to-r from-purple-500/10 to-blue-500/10">
                        <h5 class="text-white font-bold flex items-center">
                            <i class="fas fa-images text-purple-300 mr-3"></i>
                            Ảnh
                        </h5>
                        <a href="#" class="text-white/70 hover:text-white text-sm">Xem tất cả</a>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-3 gap-2">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                            <img src="~/img/default-avatar.png" alt="Photo" class="w-full h-24 object-cover rounded-xl">
                        </div>
                    </div>
                </div>

                <!-- Groups -->
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 shadow-2xl">
                    <div class="flex items-center justify-between p-6 border-b border-white/20 bg-gradient-to-r from-purple-500/10 to-blue-500/10">
                        <h5 class="text-white font-bold flex items-center">
                            <i class="fas fa-layer-group text-purple-300 mr-3"></i>
                            Nhóm
                        </h5>
                        <a href="/Group" class="text-white/70 hover:text-white text-sm">Xem tất cả</a>
                    </div>
                    <div class="p-6 space-y-3">
                        <a href="#" class="flex items-center p-3 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all">
                            <img src="~/img/default-group.png" alt="Group" class="w-10 h-10 rounded-xl ring-2 ring-white/20 mr-3">
                            <div>
                                <p class="text-white font-medium">Nhóm học tập</p>
                                <p class="text-white/60 text-xs">15 thành viên</p>
                            </div>
                        </a>
                        <a href="#" class="flex items-center p-3 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all">
                            <img src="~/img/default-group.png" alt="Group" class="w-10 h-10 rounded-xl ring-2 ring-white/20 mr-3">
                            <div>
                                <p class="text-white font-medium">Nhóm công việc</p>
                                <p class="text-white/60 text-xs">8 thành viên</p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Avatar Modal -->
<div class="modal fade" id="avatarModal" tabindex="-1" aria-labelledby="avatarModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="avatarModalLabel">
                    <i class="fas fa-camera text-primary me-2"></i>
                    Thay đổi ảnh đại diện
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form asp-controller="Profile" asp-action="UpdateAvatar" method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="avatarFile" class="form-label">Chọn ảnh đại diện</label>
                        <input type="file" class="form-control" id="avatarFile" name="avatarFile" accept="image/*">
                    </div>
                    <div class="text-center">
                        <img id="avatarPreview" src="@(Model?.Avatar ?? "~/img/default-avatar.png")" alt="Avatar Preview" class="rounded-2xl" width="150" height="150">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary">Lưu thay đổi</button>
            </div>
        </div>
    </div>
</div>

<!-- Cover Photo Modal -->
<div class="modal fade" id="coverPhotoModal" tabindex="-1" aria-labelledby="coverPhotoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="coverPhotoModalLabel">
                    <i class="fas fa-image text-primary me-2"></i>
                    Thay đổi ảnh bìa
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form asp-controller="Profile" asp-action="UpdateCoverPhoto" method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="coverFile" class="form-label">Chọn ảnh bìa</label>
                        <input type="file" class="form-control" id="coverFile" name="coverFile" accept="image/*">
                    </div>
                    <div class="text-center">
                        <img id="coverPreview" src="#" alt="Cover Preview" class="img-fluid rounded" style="max-height: 200px; display: none;">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary">Lưu thay đổi</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Avatar preview
        document.getElementById('avatarFile')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(ev) {
                    const img = document.getElementById('avatarPreview');
                    if (img) img.src = ev.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // Cover photo preview
        document.getElementById('coverFile')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(ev) {
                    const preview = document.getElementById('coverPreview');
                    if (preview) {
                        preview.src = ev.target.result;
                        preview.style.display = 'block';
                    }
                };
                reader.readAsDataURL(file);
            }
        });

        // Like buttons
        document.querySelectorAll('.like-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const icon = this.querySelector('i');
                if (icon.classList.contains('far')) {
                    icon.classList.remove('far');
                    icon.classList.add('fas');
                    this.classList.add('text-red-400');
                } else {
                    icon.classList.remove('fas');
                    icon.classList.add('far');
                    this.classList.remove('text-red-400');
                }
            });
        });
    </script>
}